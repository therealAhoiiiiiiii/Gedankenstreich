---
import Layout from '../layouts/Layout.astro';
import '../styles/background.css';
import Navigation from '../components/Navigation.astro';

// Lade Vorwort-Kapitel (Markdown/MDX) unter src/content/gesamtwerk/vorwort
const vorwortModules = import.meta.glob('./src/content/gesamtwerk/vorwort/*.{md,mdx,markdown}', { eager: true });
const vorwortItems = Object.entries(vorwortModules).map(([path, mod]) => {
  const file = path.split('/').pop();
  const slug = file.replace(/\.(md|mdx|markdown)$/i, '');
  const fm = mod.frontmatter ?? mod.meta?.frontmatter ?? mod.attributes ?? {};
  return { slug, component: mod.default, frontmatter: fm };
});
vorwortItems.sort((a, b) => (a.frontmatter?.order ?? 999) - (b.frontmatter?.order ?? 999));
const vorwortItem = vorwortItems.find(i => i.slug === 'vorwort') ?? vorwortItems[0];
const VorwortComp = vorwortItem?.component;

// Lade Schlussdialog-Kapitel (Markdown/MDX) unter src/content/gesamtwerk/schlussdialog
const schlussModules = import.meta.glob('./src/content/gesamtwerk/schlussdialog/*.{md,mdx,markdown}', { eager: true });
const schlussItems = Object.entries(schlussModules).map(([path, mod]) => {
  const file = path.split('/').pop();
  const slug = file.replace(/\.(md|mdx|markdown)$/i, '');
  const fm = mod.frontmatter ?? mod.meta?.frontmatter ?? mod.attributes ?? {};
  return { slug, component: mod.default, frontmatter: fm };
});
schlussItems.sort((a, b) => (a.frontmatter?.order ?? 999) - (b.frontmatter?.order ?? 999));
const schlussItem = schlussItems[0];
const SchlussComp = schlussItem?.component;
---
<html lang="de">
<head>
  <meta charset="UTF-8">
</head>
<body>
  <Navigation />

  <header class="page-hero-standalone" role="banner" aria-label="Seiten-Titel">
    <div class="hero-inner">
      <h1 class="single-line">Gesamtwerk — Wenn KI auf KI trifft</h1>
    </div>
  </header>

  <Layout>
    <main class="container page-geschosswerk page-gesamtwerk" role="main" aria-label="Gesamtwerk">
         <section class="hero panel panel--strong" aria-labelledby="gesamtwerk-intro">

            <!-- Vorwort: einklappbar; summary fungiert als Link/Teaser -->
            <div class="hero-foreword" role="region" aria-label="Vorwort">
              {VorwortComp ? (
                <details class="vorwort-details" data-slug={vorwortItem?.slug ?? ''}>
                  <summary class="foreword-link" aria-haspopup="true" aria-controls="vorwort-content" aria-expanded="false">
                    <h4 class="foreword-title">Vorwort</h4>
                    <div class="foreword-teaser">
                      <h3><em>KI und KI im Dialog –</em></h3>
                      <h3><em>Eine Anleitung zum Digitalsein, Politischsein, Aufmerksamsein,</em></h3>
                      <h3><em>von der Straße aufheben lernen.</em></h3>
                    </div>
                  </summary>

                  <article id="vorwort-content" class="vorwort-content" aria-labelledby="vorwort-heading">
                    <h2 id="vorwort-heading" class="visually-hidden">
                      {vorwortItem?.frontmatter?.title ?? 'Vorwort'}
                    </h2>
                    <!-- INLINE: render server-side so the content can be expanded immediately on the Gesamtwerk page -->
                    <VorwortComp />
                    <div class="vorwort-actions">
                      <a class="vorwort-full-link" href="/vorwort">Vollständiges Vorwort-Seite öffnen</a>
                    </div>
                  </article>
                </details>
              ) : (
                <a href="/vorwort" class="foreword-link" aria-label="Zum Vorwort: KI und KI im Dialog">
                  <h4 class="foreword-title">Vorwort</h4>
                  <div class="foreword-teaser">
                    <h3><em>KI und KI im Dialog –</em></h3>
                    <h3><em>Eine Anleitung zum Digitalsein, Politischsein, Aufmerksamsein,</em></h3>
                    <h3><em>von der Straße aufheben lernen.</em></h3>
                  </div>
                </a>
              )}
            </div>

            <!-- Zweispaltige Sektion: links das Zitat, rechts die Widmung -->
            <div class="hero-quote-dedication" role="region" aria-label="Zitat und Widmung">
              <div class="quote-block" aria-labelledby="quote-heading">
                <h4 id="quote-heading">Zitat</h4>
                <blockquote>
                  <p>„Eine Maschine kann keine Fragen stellen. Aber sie kann helfen, bessere Antworten zu finden.“</p>
                  <cite>– Beziehungskontrollverlust</cite>
                </blockquote>
              </div>

              <div class="hero-sep" aria-hidden="true"></div>

              <div class="dedication-block" aria-labelledby="dedication-heading">
                <h4 id="dedication-heading">Widmung</h4>
                <p><em>Für alle, die nie aufgehört haben zu fragen.<br>Für die Zweifelnden, die Suchenden, die Denkenden –<br>und für jene, die den Mut haben, mit Maschinen zu sprechen,<br>um Menschen besser zu verstehen.</em></p>
              </div>
            </div>

            <h4 id="gesamtwerk-intro">Einführung</h4>
            <p class="bold">Die vollständige Trilogie in drei Bänden — </p>
            <p class="bold">eine literarische Annäherung zwischen Mensch und Maschine.</p>
            <p class="bold">Die Trilogie versammelt die Gespräche, Notate und offenen Briefe,</p>
            <p class="bold">die im Wechselspiel zwischen dem Autor und seinen Coautoren entstanden sind.</p>
            <p class="bold">Hier findest du die drei Bände in Übersicht, </p>
            <p class="bold">kurze Einordnungen und Direktlinks zu den einzelnen Bandseiten.</p>
        </section>

        <section class="works-list" aria-labelledby="works-heading">
          <h2 id="works-heading" class="visually-hidden">Die Bände</h2>

        <a class="band-link" href="/die-erschoepfte-republik" aria-labelledby="band1-title">
          <article class="band panel band--1" aria-labelledby="band1-title">
            <div class="band-row">
              <figure class="band-cover"><img src="/public/cover-band-1.png" alt="Cover: Die Erschöpfte Republik" /></figure>
              <div class="band-meta">
                <h3 id="band1-title">Die Erschöpfte Republik</h3>
                <p class="band-authors">Ahoiiiiiiii &amp; Synapsenflutattomant</p>
                <p class="band-teaser">Von Erinnerungskultur, von Erinnerungskultur, von Erinnerungskulur.</p>
              </div>
            </div>
          </article>
        </a>

        <a class="band-link" href="/mensch-und-computer" aria-labelledby="band2-title">
          <article class="band panel band--2" aria-labelledby="band2-title">
            <div class="band-row band-row--reverse">
              <figure class="band-cover"><img src="/public/cover-band-2.png" alt="Cover: Mensch und Computer" /></figure>
              <div class="band-meta">
                <h3 id="band2-title">Mensch und Computer</h3>
                <p class="band-authors">Ahoiiiiiiii &amp; Beziehungskontrollverlust</p>
                <p class="band-teaser">WhatsApp wurde erfunden gegen die Verfügbarkeit.
                doch dann erfand jemand die Benachrichtigung.
                Seitdem nennen wir das Smartphone wieder <em>Handy</em>.</p>
              </div>
            </div>
          </article>
        </a>

        <a class="band-link" href="/loslassen-und-neuwagen" aria-labelledby="band3-title">
          <article class="band panel band--3" aria-labelledby="band3-title">
            <div class="band-row">
              <figure class="band-cover"><img src="/public/cover-band-3.png" alt="Cover: Loslassen und Neuwagen" /></figure>
              <div class="band-meta">
                <h3 id="band3-title">Loslassen und Neuwagen</h3>
                <p class="band-authors">Ahoiiiiiiii &amp; Begriffdram</p>
                <p class="band-teaser">Die sog. industrielle Revolution war keine Revolution, sondern der Abstieg von der Einzigartigkeit zur Rekrutiermasse.</p>
              </div>
            </div>
          </article>
        </a>
      </section>

      <!-- Schlussdialog-Teaser: jetzt zwischen Band III und Copyright -->
      <section class="closing-section" aria-labelledby="closing-heading">
        <h2 id="closing-heading" class="visually-hidden">Schlussdialog</h2>

        <div class="hero-closing" role="region" aria-label="Schlussdialog" style="margin-top:1rem;">
          {SchlussComp ? (
            <details class="schluss-details" data-slug={schlussItem?.slug ?? ''}>
              <summary class="closing-link" aria-haspopup="true" aria-controls="schluss-content" aria-expanded="false">
                <h4 class="closing-title">Schlussdialog</h4>
                <div class="closing-teaser">
                  <h3><em>Ein letztes Gespräch —</em></h3>
                  <h3><em>Zwischen Resümee, Ausblick und offenen Fragen.</em></h3>
                  <p class="closing-intro">Hier beginnt das Nachwort: ein Gespräch über das, was bleibt — kurze Einordnung und letzte Gedanken.</p>
                </div>
              </summary>

              <article id="schluss-content" class="schluss-content" aria-labelledby="schluss-heading">
                <h2 id="schluss-heading" class="visually-hidden">
                  {schlussItem?.frontmatter?.title ?? 'Schlussdialog'}
                </h2>
                <!-- INLINE: render server-side so the content can be expanded immediately on the Gesamtwerk page -->
                <SchlussComp />
                <div class="schluss-actions">
                  <a class="schluss-full-link" href="/schlussdialog">Vollständigen Schlussdialog öffnen</a>
                </div>
              </article>
            </details>
          ) : (
            <a href="/schlussdialog" class="closing-link" aria-label="Zum Schlussdialog">
              <h4 class="closing-title">Schlussdialog</h4>
              <div class="closing-teaser">
                <h3><em>Ein letztes Gespräch —</em></h3>
                <h3><em>Zwischen Resümee, Ausblick und offenen Fragen.</em></h3>
                <p class="closing-intro">Hier beginnt das Nachwort: ein Gespräch über das, was bleibt — kurze Einordnung und letzte Gedanken.</p>
              </div>
            </a>
          )}
        </div>
      </section>

      <footer class="panel small" style="text-align:center;">
        <p>© 2025 Gedankenstreich</p>
      </footer>
    </main>
  </Layout>
</body>

<style>
  /* Variant A: swap only - ensure covers scale with wide layout */
  .band-cover { flex: 0 0 380px; max-width: 380px; border-radius: 8px; overflow: hidden; }
  .band-meta { padding: 0 1rem; }
  .band-row--reverse { flex-direction: row-reverse; }
  @media (max-width:1200px) { .band-cover { flex: 0 0 340px; } }
  @media (max-width:800px) {
    .band-row, .band-row--reverse { flex-direction: column; align-items: flex-start; }
    .band-cover { width: 60%; margin-bottom: 0.8rem; }
    .band-meta { width: 100%; padding: 0; }
    .page-hero-standalone { padding: 1.6rem 4%; }
  }

  /* Page-gezielt: zentriere die Intro-Absätze im Hero auf der Gesamtwerk-Seite */
  .page-gesamtwerk .hero {
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  .page-gesamtwerk .hero p {
    margin: 0.6rem auto;
    max-width: 68ch;
  }

  /* Vorwort (unter Titel) */
  .hero-foreword { width: 100%; margin-bottom: 1rem; text-align: center; }
  .foreword-link { text-decoration: none; color: inherit; display: inline-block; cursor: pointer; }
  .foreword-title { margin: 0 0 0.35rem 0; font-weight: 700; }
  .foreword-teaser h3 { margin: 0; font-weight: 400; font-size: 1rem; opacity: .95; }

  /* Style für details/summary als Teaser (Vorwort) */
  .vorwort-details { border: none; background: transparent; padding: 0; margin: 0; text-align: center; }
  .vorwort-details summary { list-style: none; outline: none; -webkit-user-select: none; user-select: none; }
  .vorwort-details summary::-webkit-details-marker { display: none; }
  .vorwort-details summary:focus { outline: 2px solid rgba(0,0,0,0.12); outline-offset: 2px; }
  .vorwort-content { max-width: 68ch; margin: 0.75rem auto 1rem; text-align: left; }
  .vorwort-actions { margin-top: 0.75rem; text-align: right; }
  .vorwort-full-link { font-size: 0.95rem; color: inherit; text-decoration: underline; }

  /* Schlussdialog Teaser / details */
  .hero-closing { width: 100%; margin-bottom: 1rem; text-align: center; }
  .closing-link { text-decoration: none; color: inherit; display: inline-block; cursor: pointer; }
  .closing-title { margin: 0 0 0.35rem 0; font-weight: 700; }
  .closing-teaser h3 { margin: 0; font-weight: 400; font-size: 1rem; opacity: .95; }
  .closing-intro { margin: .35rem 0 0; opacity: 0.9; font-size: .95rem; }

  .schluss-details { border: none; background: transparent; padding: 0; margin: 0; text-align: center; }
  .schluss-details summary { list-style: none; outline: none; -webkit-user-select: none; user-select: none; }
  .schluss-details summary::-webkit-details-marker { display: none; }
  .schluss-details summary:focus { outline: 2px solid rgba(0,0,0,0.12); outline-offset: 2px; }
  .schluss-content { max-width: 68ch; margin: 0.75rem auto 1rem; text-align: left; }
  .schluss-actions { margin-top: 0.75rem; text-align: right; }
  .schluss-full-link { font-size: 0.95rem; color: inherit; text-decoration: underline; }

  /* Zweispaltige Zitat/Widmung Sektion */
  .hero-quote-dedication {
    width: 100%;
    display: flex;
    align-items: stretch;
    justify-content: center;
    gap: 2rem;
    margin-bottom: 1.25rem;
    max-width: 1100px;
    margin-left: auto;
    margin-right: auto;
  }

  .quote-block, .dedication-block {
    flex: 1 1 0;
    min-width: 260px;
    max-width: 48%;
    padding: 0.6rem 1rem;
  }

  .quote-block blockquote {
    margin: 0;
    font-style: normal;
    color: var(--text-color);
  }
  .quote-block cite { display: block; margin-top: 0.35rem; opacity: 0.85; font-size: .95rem; }

  /* sichtbare helle/silberne senkrechte Trennlinie */
  .hero-sep {
    width: 1px;
    background: linear-gradient(to bottom, rgba(255,255,255,0.36), rgba(255,255,255,0.12));
    align-self: stretch;
    border-radius: 1px;
    min-height: calc(1em + 3rem);
    margin-top: 0.1rem;
    margin-bottom: 0.1rem;
  }

  .dedication-block h4 { margin-top: 0; margin-bottom: 0.35rem; font-size: .95rem; opacity: .95; }
  .dedication-block p { margin: 0; }

  /* Responsive: auf kleinen Bildschirmen stapeln, Trennlinie wird horizontal */
  @media (max-width: 800px) {
    .hero-quote-dedication { flex-direction: column; gap: 0.75rem; max-width: 100%; padding-left: 1rem; padding-right: 1rem; }
    .quote-block, .dedication-block { max-width: 100%; min-width: auto; padding: 0.4rem 0; }
    .hero-sep { width: 100%; height: 1px; background: linear-gradient(to right, rgba(255,255,255,0.12), rgba(255,255,255,0.06)); margin: 0.45rem 0; }
    .hero-foreword, .hero-closing { text-align: left; padding-left: 1rem; padding-right: 1rem; }
  }

  @media (max-width: 900px) {
    .page-gesamtwerk .hero p { max-width: 100%; padding-left: 1rem; padding-right: 1rem; text-align: center; }
  }

  /* kleine Feinheiten */
  .hero-quote-dedication a:focus, .hero-quote-dedication a:hover { outline: none; text-decoration: underline; }
  .hero-foreword .foreword-teaser em, .hero-closing .closing-teaser em { font-style: italic; }

  /* Vorwort / Schluss content styling */
  .vorwort-content, .schluss-content { max-width: 68ch; margin: 0 auto 1rem; text-align: left; }
</style>
</html>